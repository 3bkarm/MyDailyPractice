## [Minimum Number of Increments on Subarrays to Form a Target Array](https://leetcode.com/problems/minimum-number-of-increments-on-subarrays-to-form-a-target-array?envType=daily-question&envId=2025-10-30)
```java
class Solution {
    private final static int limit = 100_001;
    private static ArrayList<Integer>[] adj;

    static {
        adj = new ArrayList[limit];
        for (int i = 0; i < limit; ++i) {
            adj[i] = new ArrayList<>();
        }
    }

    public int minNumberOperations(int[] target) {
        int n = target.length, ans = 0;
        for (int i = 0; i < n; ++i) {
            adj[ target[i] ].add(i);
        }
        boolean[] done = new boolean[n];
        int[] value = Arrays.copyOf(target, n);
        Arrays.sort(value);
        for (int i = n - 1, count = 0; i >= 0; --i) {
            if (i - 1 >= 0 && value[i - 1] == value[i]) {
                continue;
            }
            int d = value[i];
            if (i > 0) {
                d -= value[i - 1];
            }
            for (int ix : adj[ value[i] ]) {
                if (done[ix]) {
                    continue;
                }
                ++count;
                done[ix] = true;
                int l = ix, r = ix;
                while (l - 1 >= 0 && target[l - 1] >= value[i]) {
                    --l;
                    if (done[l]) {
                        --count;
                        break;
                    }
                    done[l] = true;
                }
                while (r + 1 < n && target[r + 1] >= value[i]) {
                    ++r;
                    if (done[r]) {
                        --count;
                        break;
                    } 
                    done[r] = true;
                }
            }
            ans += count * d;
        }
        for (int i = 0; i < n; ++i) {
            adj[ target[i] ].removeLast();
        }
        return ans;
    }
}
```
